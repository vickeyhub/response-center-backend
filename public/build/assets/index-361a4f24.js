import{q as f,_ as k,r as h,o as i,f as d,e as r,w as b,b as e,F as g,j as C,l as x,h as v,t as m,k as $,v as R,n as D}from"./app-1983373d.js";import{B as U}from"./Breadcrumb-0722ea03.js";import{L as O}from"./LeftSideHeader-ba42ca70.js";function P(t){return f({url:`/api/users${t}`,method:"get"})}function B(t){return f({url:`/api/users/${t}`,method:"get"})}function M(t){return f({url:`/api/users/${t}`,method:"delete"})}function V(t){return f({url:"/api/remove-users",method:"post",data:t})}function S(t){return f({url:"/api/users",method:"post",data:t})}function y(t,s){return f({url:`/api/users/${s}`,method:"put",data:t})}function A(){return f({url:"/api/roles",method:"get"})}const L={name:"Specialities",props:{userData:{type:Object,default:{}},id:{type:Number,default:0}},data(){return{submittingForm:!1,showMsg:!1,msg:null,msgType:"success",name:this.id>0?this.userData.name:null,email:this.id>0?this.userData.email:null,role_id:this.id>0?this.userData.role_id:null,schema:{name:"required|min:3|max:50|regex:^([^0-9]*)$",email:"required|email",role_id:"required"},roles:[],msgClass:"text-success"}},mounted(){this.getRoles()},methods:{getRoles(){A().then(t=>{this.roles=t.data})},submit(t,{resetForm:s}){this.submittingForm=!0;const u={name:this.name,email:this.email,role_id:this.role_id};this.id>0?y(u,this.id).then(o=>{this.submittingForm=!1,this.handleResponse(o),o.success==!0&&(this.name="",this.email="",this.role_id="",this.$emit("changePage",0))}).catch(o=>{this.submittingForm=!1,this.handleCatch(o)}):S(u).then(o=>{this.submittingForm=!1,this.handleResponse(o),o.success==!0&&(s(),this.$emit("changePage",0))}).catch(o=>{this.submittingForm=!1,this.handleCatch(o)})}}},F={class:"form-box mb-3"},N={class:"row"},E={class:"col-12 col-xl-3"},I={class:"form-field"},T={class:"error invalid-feedback"},q={class:"col-12 col-xl-3"},j={class:"form-field"},H={class:"error invalid-feedback"},G={class:"col-12 col-xl-3"},z={class:"form-field"},Y=e("option",{value:""},"Select Role",-1),J=["value"],K={class:"error invalid-feedback"},Q={class:"col-12 col-sm-auto"},W={class:"submit-wrap"},X={type:"submit",class:"btn btn-primary-light btn-medium min-small"},Z={key:0,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",style:{margin:"0 10px"},width:"24px",height:"24px",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},ee=e("circle",{cx:"50",cy:"50",r:"32","stroke-width":"8",stroke:"#3A89C9","stroke-dasharray":"50.26548245743669 50.26548245743669",fill:"none","stroke-linecap":"round"},[e("animateTransform",{attributeName:"transform",type:"rotate",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"0 50 50;360 50 50"})],-1),te=[ee];function se(t,s,u,o,a,c){const _=h("vee-field"),n=h("ErrorMessage"),p=h("vee-form");return i(),d("div",F,[r(p,{"validation-schema":a.schema,onSubmit:c.submit},{default:b(()=>[e("div",N,[e("div",E,[e("div",I,[r(_,{name:"name",type:"text",modelValue:a.name,"onUpdate:modelValue":s[0]||(s[0]=l=>a.name=l),validateOnModelUpdate:!1,validateOnBlur:!1,validateOnChange:!1,validateOnInput:!1,validateOnMount:!1,class:"form-control",placeholder:"Enter Name"},null,8,["modelValue"]),e("div",T,[r(n,{class:"error invalid-feedback",name:"name"})])])]),e("div",q,[e("div",j,[r(_,{name:"email",type:"text",modelValue:a.email,"onUpdate:modelValue":s[1]||(s[1]=l=>a.email=l),validateOnModelUpdate:!1,validateOnBlur:!1,validateOnChange:!1,validateOnInput:!1,validateOnMount:!1,class:"form-control",placeholder:"Enter Email"},null,8,["modelValue"]),e("div",H,[r(n,{class:"invalid-feedback",name:"email"})])])]),e("div",G,[e("div",z,[r(_,{name:"role_id",as:"select",modelValue:a.role_id,"onUpdate:modelValue":s[2]||(s[2]=l=>a.role_id=l),validateOnModelUpdate:!1,validateOnBlur:!1,validateOnChange:!1,validateOnInput:!1,validateOnMount:!1,class:"form-select"},{default:b(()=>[Y,(i(!0),d(g,null,C(a.roles,(l,w)=>(i(),d("option",{key:w,value:l.id},m(l.name),9,J))),128))]),_:1},8,["modelValue"]),e("div",K,[r(n,{class:"invalid-feedback",name:"role_id"})])])]),e("div",Q,[e("div",W,[e("button",X,[a.submittingForm?(i(),d("svg",Z,te)):x("",!0),v(" "+m(u.id==0?"Add":"Update"),1)])])])])]),_:1},8,["validation-schema","onSubmit"])])}const ae=k(L,[["render",se]]),ne={props:{users:Array,totalCount:Number},data(){return{selectedUsers:[]}},methods:{changePage(t){this.$emit("changePage",(t-1)*10)},editRecord(t){this.$emit("getRecord",t)},deleteRecord(t){this.$swal({title:"Are you sure ?",showCancelButton:!0,icon:"",confirmButtonText:"Continue"}).then(s=>{s.isConfirmed&&M(t).then(()=>{this.$emit("changePage",0)})})},deleteData(){const t=this.selectedUsers;this.$swal({title:"Are you sure ?",showCancelButton:!0,icon:"",confirmButtonText:"Continue"}).then(s=>{s.isConfirmed&&V({user_ids:t}).then(()=>{this.$emit("changePage",0),this.selectedUsers=[]})})},updateStatus(t,s){t.status=s,y(t,t.id).then(()=>{this.$emit("changePage",0)}).catch(u=>{var o;(o=u.response)!=null&&o.data&&console.log(response.message)})}}},oe={class:"table-responsive"},le={class:"table align-middle"},ie=e("thead",null,[e("tr",null,[e("th",{width:"45px"}),e("th",null,"Name"),e("th",null,"Email"),e("th",null,"Role"),e("th",{width:"250"},"Status"),e("th",{width:"150"},"Action")])],-1),de={key:0},ce=["value"],re=["onClick"],ue={class:"actions"},he=["onClick"],me=e("i",{class:"icon-edit"},null,-1),_e=["onClick"],fe=e("i",{class:"icon-delete"},null,-1),pe={key:1},ge=e("tr",null,[e("td",{colspan:"6",class:"text-center"},"No record found")],-1),ve=[ge],be={class:"row gy-4 align-items-center"},Ce={class:"col-auto"},ke=["disabled"],xe={class:"col-auto ms-auto"},ye={class:"row align-items-center justify-content-end"},we=e("div",{class:"col-auto"},"Page",-1),$e={class:"col ps-0"},Re={class:"pagination-wrap"},De={class:"pagination flex-wrap pagination-sm mb-0"},Ue={class:"page-item"};function Oe(t,s,u,o,a,c){const _=h("btn");return i(),d(g,null,[e("div",oe,[e("table",le,[ie,u.users.length?(i(),d("tbody",de,[(i(!0),d(g,null,C(u.users,(n,p)=>(i(),d("tr",{key:p},[e("td",null,[$(e("input",{class:"form-check-input",value:n.id,"onUpdate:modelValue":s[0]||(s[0]=l=>a.selectedUsers=l),type:"checkbox"},null,8,ce),[[R,a.selectedUsers]])]),e("td",null,m(n.name),1),e("td",null,m(n.email),1),e("td",null,m(n.role?n.role.name:"intake"),1),e("td",null,[e("span",{onClick:l=>c.updateStatus(n,n.status===1?0:1),class:D(n.status==1?"status active":"status")},null,10,re)]),e("td",null,[e("ul",ue,[e("li",null,[e("button",{class:"btn btn-link",onClick:l=>c.editRecord(n.id)},[me,v("Edit ")],8,he)]),e("li",null,[e("button",{class:"btn",onClick:l=>c.deleteRecord(n.id)},[fe,v("Delete ")],8,_e)])])])]))),128))])):(i(),d("tbody",pe,ve))])]),e("div",be,[e("div",Ce,[e("button",{class:"btn btn-danger py-2",onClick:s[1]||(s[1]=(...n)=>c.deleteData&&c.deleteData(...n)),disabled:!a.selectedUsers.length}," Delete Selected ",8,ke)]),e("div",xe,[e("div",ye,[we,e("div",$e,[e("nav",Re,[e("ul",De,[(i(!0),d(g,null,C(u.totalCount,n=>(i(),d("div",null,[e("li",Ue,[r(_,{onClick:p=>c.changePage(n),class:"page-link",href:"#"},{default:b(()=>[v(m(n),1)]),_:2},1032,["onClick"])])]))),256))])])])])])])],64)}const Pe=k(ne,[["render",Oe]]),Be={name:"Users",components:{Add:ae,List:Pe,Breadcrumb:U,LeftSideHeader:O},data(){return{users:[],totalPages:1,totalRecords:0,displayComponent:!0,userData:{},userId:0,breadcrumbs:[{class:null,url:"#",name:"Masters"},{class:"active",url:"",name:"Users"}]}},created(){this.getData()},methods:{getData(t=0){this.listLoading=!0,this.userData={},this.userId=0,P("?skip="+t).then(s=>{this.totalRecords=s.data.totalRecords,this.totalPages=s.data.totalRecords>10?Math.ceil(s.data.totalRecords/10):1,this.users=s.data.data})},getUser(t){this.displayComponent=!1,B(t).then(s=>{this.displayComponent=!0,s.success===!0&&(this.userData=s.data,this.userId=s.data.id)})}}},Me={class:"section-content bg-white col p-4"},Ve={class:"title-box"},Se={class:"row gy-3"},Ae={class:"content-wrap pt-4"},Le={key:0},Fe={class:"row mb-3 align-items-center"},Ne={class:"col"},Ee={class:"data-info"};function Ie(t,s,u,o,a,c){const _=h("Breadcrumb"),n=h("LeftSideHeader"),p=h("Add"),l=h("List");return i(),d("section",Me,[r(_,{crumbs:a.breadcrumbs},null,8,["crumbs"]),e("div",Ve,[e("div",Se,[r(n,{headerData:"Users"})])]),e("div",Ae,[a.displayComponent?(i(),d("div",Le,[r(p,{userData:a.userData,id:a.userId,onChangePage:c.getData},null,8,["userData","id","onChangePage"])])):x("",!0),e("div",Fe,[e("div",Ne,[e("div",Ee," Showing "+m(a.users.length)+" of "+m(a.totalRecords)+" Results ",1)])]),r(l,{users:a.users,totalCount:a.totalPages,onChangePage:c.getData,onGetRecord:c.getUser},null,8,["users","totalCount","onChangePage","onGetRecord"])])])}const He=k(Be,[["render",Ie]]);export{He as default};
