import{C as V}from"./flatpickr-8c54c1e2.js";import{_ as j,d as N,r as g,o as l,f as a,b as e,l as r,F as y,j as b,t as c,h as m,e as p,w as v,x as F,A as Y,y as I,z as U}from"./app-1983373d.js";import{C as x,a as E,g as O,r as T,u as q}from"./appointment-a94c1285.js";const S=new Date;let B=S.getDate(),L=S.getMonth()+1,z=S.getFullYear(),C=`${z}-${L}-${B}`;const G={props:{appointments:Array,totalCount:Number,type:String},components:{flatPickr:V},data(){return{statusAppointment:{},submittingForm:!1,currentDate:C,displayReason:!1,displayPaymentMode:!1,updatedStatus:"",payment_mode:null,appointmentId:null,cancellationReason:null,appointment:{},date:null,slots:[],displayOverlay:!1,schema:{reason:"",payment_mode:""},config:{altInput:!0,altFormat:"j F, Y",dateFormat:"Y-m-d",minDate:C,disableMobile:!0},noSlots:!1,pendingStatuses:[{type:"pending",text:"Confirmed",value:"booked"},{type:"",text:"Cancel",value:"cancelled"}],confirmedStatuses:[{type:"",text:"Cancel",value:"cancelled"},{text:"Fulfilled",value:"fulfilled"},{text:"Arrived",value:"arrived"}],paymentMode:[{text:"Cash",value:"cash"},{text:"Credit/Debit Card",value:"credit/debit card"},{text:"Cheque",value:"cheque"}],statusErr:!1}},methods:{changePage(o){this.$emit("changePage",(o-1)*10)},getAppointmentInfo(o){E(o).then(i=>{i.success===!0&&(this.appointment=i.data)})},getClinicianSlots(){if(this.date==null||this.date=="")return!1;if(this.date!=null||this.date!=""){this.displayOverlay=!0,this.noSlots=!1;const o=`?date=${this.date}&location=${this.appointment.location}&clinician=${this.appointment.clinician.azalea_id}`;O(o).then(i=>{if(i.success===!0){const d=i.data;if(Object.keys(d).length){const h=Object.keys(i.data)[0];this.slots=i.data[h],this.displayOverlay=!1}else this.slots=[],this.noSlots=!0,this.displayOverlay=!1}})}},reschedule(o,i){this.displayOverlay=!0;const d={appointment_id:i,appointmentType:o.appointmentType,end_date_time:o.end_date_time,start_date_time:o.start_date_time,time:o.start_time,date:o.formatted_date};T(d).then(h=>{this.displayOverlay=!1,N.useToast().open({message:h.message,type:h.success===!0?"success":"error",position:"top-right"}),h.success===!0&&(this.closeModal(),this.$emit("changePage",0))})},changeStatus(){this.cancellationReason=null,this.displayReason=!1,this.displayPaymentMode=!1,this.updatedStatus=="cancelled"?(this.displayReason=!0,this.schema.reason="required"):this.updatedStatus=="fulfilled"?(this.displayPaymentMode=!0,this.schema.payment_mode="required"):(this.displayReason=!1,this.schema.reason="")},updateStatus(o,{resetForm:i}){if(this.statusErr=!1,this.updatedStatus=="")this.statusErr=!0;else{let d=new FormData;this.submittingForm=!0,d.append("appointment_id",this.appointmentId),d.append("cancellation_reason",this.cancellationReason),d.append("status",this.updatedStatus),d.append("payment_mode",this.payment_mode),q(d).then(h=>{this.handleResponse(h),this.submittingForm=!1,h.success==!0&&(i(),this.closeModal(),this.$emit("changePage",0))}).catch(h=>{this.submittingForm=!1,this.handleCatch(h)})}},closeModal(){this.noSlots=!1,this.slots=[],this.date=null,this.appointmentId=null,this.cancellationReason=null,this.displayReason=!1,this.updatedStatus="",this.displayPaymentMode=!1,this.statusErr=!1,x.close()}}};x.bind("[data-fancybox]",{closeButton:!1,backdropClick:!1});const n=o=>(I("data-v-815cd5a2"),o=o(),U(),o),H={class:"table-responsive"},J={class:"table align-middle"},K=n(()=>e("th",null,"Reference No.",-1)),Q=n(()=>e("th",null,"Name",-1)),W=n(()=>e("th",null,"Clinician",-1)),X={key:0},Z={key:1},$=n(()=>e("th",null,"Payment Type",-1)),ee=n(()=>e("th",null,"Date",-1)),te=n(()=>e("th",null,"Status",-1)),se=n(()=>e("th",null,"Action",-1)),le={key:0},ae=n(()=>e("br",null,null,-1)),oe={key:0},ne={class:"row flex-nowrap align-items-center"},ie={class:"col"},de={class:"user-info"},ce={key:0},re={key:1},ue=n(()=>e("i",{class:"bi bi-clock"},null,-1)),_e={style:{"white-space":"nowrap"}},he={class:"actions"},me=n(()=>e("i",{class:"bi bi-eye fs-5",title:"View"},null,-1)),pe=["onClick"],fe=n(()=>e("button",{"data-fancybox":"","data-src":"#dialog-content",class:"btn btn-link text-success",title:"Reschedule",alt:"Reschedule"},[e("i",{class:"bi bi-arrow-clockwise fs-5",title:"Reschedule",alt:"Reschedule"})],-1)),ye=[fe],ve=["onClick"],ge=n(()=>e("button",{"data-fancybox":"","data-src":"#status-dialog-content",class:"btn btn-link text-danger",title:"Update Status",alt:"Update Status"},[e("i",{class:"bi bi-pencil-square fs-5",style:{"font-size":"17px !important","line-height":"32px"},title:"Update Status",alt:"Update Status"})],-1)),be=[ge],ke={key:1},we=["colspan"],Se={class:"row gy-4 align-items-center"},Ce=n(()=>e("div",{class:"col-auto"},null,-1)),xe={class:"col-auto ms-auto"},Me={class:"row align-items-center justify-content-end"},Ae=n(()=>e("div",{class:"col-auto"},"Page",-1)),Re={class:"col ps-0"},De={class:"pagination-wrap"},Pe={class:"pagination flex-wrap pagination-sm mb-0"},Ve={class:"page-item"},je={id:"dialog-content",class:"popup"},Ne=n(()=>e("h2",null,"Reschedule Appointment",-1)),Fe=n(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",tabindex:"-1"},[e("path",{d:"M20 20L4 4m16 0L4 20"})],-1)),Ye=[Fe],Ie={key:0,class:"overlay"},Ue=n(()=>e("div",{class:"overlay__inner"},[e("div",{class:"overlay__content"},[e("span",{class:"spinner"})])],-1)),Ee=[Ue],Oe={class:"card card-3 mt-1"},Te={class:"fw-bold"},qe=n(()=>e("label",{for:""},[m("Select New Date"),e("span",null,"*")],-1)),Be={key:0,class:"error invalid-feedback"},Le={key:0,class:"card-footer mt-4"},ze=n(()=>e("div",{class:"card-ft"},"Available Appointment Slots",-1)),Ge={class:"card-ftwrp",style:{"max-height":"250px"}},He={class:"row align-items-center"},Je={class:"col"},Ke={class:"card-fdate"},Qe={class:"col-auto"},We={class:"card-fbtn"},Xe=["onClick"],Ze=n(()=>e("i",{class:"bi bi-arrow-right-short ms-2"},null,-1)),$e={key:1,class:"bg-warning rounded-3 p-4 mt-4"},et={id:"status-dialog-content",class:"popup"},tt=n(()=>e("h2",null,"Update Status",-1)),st=n(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",tabindex:"-1"},[e("path",{d:"M20 20L4 4m16 0L4 20"})],-1)),lt=[st],at={class:"card card-3 mt-2"},ot={class:"row"},nt={class:"col-12"},it={class:"form-field"},dt=n(()=>e("label",{for:""},[m("Select Status"),e("span",null,"*")],-1)),ct=n(()=>e("option",{value:""},"Select Status",-1)),rt=["value"],ut=["value"],_t={key:0,class:"error invalid-feedback"},ht=n(()=>e("p",{class:"invalid-feedback"}," This field is required. ",-1)),mt=[ht],pt={key:0,class:"col-12"},ft={class:"form-field"},yt=n(()=>e("label",{for:""},[m("Reason"),e("span",null,"*")],-1)),vt={key:0,class:"error invalid-feedback"},gt={key:1,class:"col-12"},bt={class:"form-field"},kt=n(()=>e("label",{for:""},[m("Select Payment Mode"),e("span",null,"*")],-1)),wt=n(()=>e("option",{value:""},"Select Mode",-1)),St=["value"],Ct={class:"error invalid-feedback"},xt={class:"col-sm-auto"},Mt={class:"submit-wrap"},At={type:"submit",class:"btn btn-primary-light btn-medium min-small"},Rt={key:0,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",style:{margin:"0 10px"},width:"24px",height:"24px",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},Dt=n(()=>e("circle",{cx:"50",cy:"50",r:"32","stroke-width":"8",stroke:"#3A89C9","stroke-dasharray":"50.26548245743669 50.26548245743669",fill:"none","stroke-linecap":"round"},[e("animateTransform",{attributeName:"transform",type:"rotate",repeatCount:"indefinite",dur:"1s",keyTimes:"0;1",values:"0 50 50;360 50 50"})],-1)),Pt=[Dt];function Vt(o,i,d,h,s,f){const M=g("router-link"),A=g("btn"),R=g("flat-pickr"),w=g("vee-field"),D=g("ErrorMessage"),P=g("vee-form");return l(),a(y,null,[e("div",H,[e("table",J,[e("thead",null,[e("tr",null,[K,Q,W,d.type=="referral"?(l(),a("th",X,"Referral Dr. Name")):r("",!0),d.type=="referral"?(l(),a("th",Z,"Type")):r("",!0),$,ee,te,se])]),d.appointments.length?(l(),a("tbody",le,[(l(!0),a(y,null,b(d.appointments,(t,_)=>(l(),a("tr",{key:_},[e("td",null,"#"+c(t.reference_id),1),e("td",null,[m(c(t.first_name)+" "+c(t.last_name),1),ae,t.home_phone!=""||t.home_phone!=null?(l(),a("small",oe,"Mobile No.: "+c(t.home_phone),1)):r("",!0)]),e("td",null,[e("div",ne,[e("div",ie,[e("div",de,[e("strong",null,c(t.clinician?t.clinician.name:"N/A"),1),e("small",null,c(t.clinician?t.clinician.qualification:"N/A"),1)])])])]),d.type=="referral"?(l(),a("td",ce,c(t.referral?t.referral.dr_name:"N/A"),1)):r("",!0),d.type=="referral"?(l(),a("td",re,c(t.referral?t.referral.type:"N/A"),1)):r("",!0),e("td",null,c(t.payment_mode),1),e("td",null,[e("strong",null,c(o.$dayjs(t.date).format("MMM DD, YYYY")),1),e("div",null,[e("small",null,[ue,m(" "+c(t.time),1)])])]),e("td",null,c(t.status),1),e("td",_e,[e("ul",he,[e("li",null,[p(M,{to:`/${d.type}-appointments/${t.id}`,class:"btn btn-link",title:"View",alt:"View"},{default:v(()=>[me]),_:2},1032,["to"])]),d.type=="confirmed"&&t.status!="Cancelled"&&t.status!="Arrived"&&t.status!="Fulfilled"&&o.$dayjs(t.date).isAfter(o.$dayjs(s.currentDate))?(l(),a("li",{key:0,onClick:u=>f.getAppointmentInfo(t.id)},ye,8,pe)):r("",!0),t.status!="Cancelled"&&o.$dayjs(t.date).isSame(o.$dayjs(s.currentDate))||o.$dayjs(t.date).isAfter(o.$dayjs(s.currentDate))?(l(),a("li",{key:1,onClick:u=>{s.appointmentId=t.id,s.statusAppointment=t}},be,8,ve)):r("",!0)])])]))),128))])):(l(),a("tbody",ke,[e("tr",null,[e("td",{colspan:d.type=="referral"?"8":"6",class:"text-center"}," No appointment scheduled yet ",8,we)])]))])]),e("div",Se,[Ce,e("div",xe,[e("div",Me,[Ae,e("div",Re,[e("nav",De,[e("ul",Pe,[(l(!0),a(y,null,b(d.totalCount,t=>(l(),a("div",null,[e("li",Ve,[p(A,{onClick:_=>f.changePage(t),class:"page-link",href:"#"},{default:v(()=>[m(c(t),1)]),_:2},1032,["onClick"])])]))),256))])])])])])]),e("div",je,[Ne,e("button",{"data-fancybox-close":"",class:"f-button is-close-btn",onClick:i[0]||(i[0]=t=>f.closeModal()),title:"Close"},Ye),s.displayOverlay?(l(),a("div",Ie,Ee)):r("",!0),e("div",Oe,[e("p",null,[e("span",Te,c(s.appointment.first_name)+" "+c(s.appointment.last_name),1),m(" / Date: "+c(o.$dayjs(s.appointment.date).format("MMM DD, YYYY"))+" @ "+c(s.appointment.time),1)]),p(w,{class:"form-control",name:"categories",type:"text"},{default:v(({field:t,errors:_})=>[qe,p(R,{modelValue:s.date,"onUpdate:modelValue":i[1]||(i[1]=u=>s.date=u),config:s.config,onChange:f.getClinicianSlots,placeholder:"Select date"},null,8,["modelValue","config","onChange"]),_[0]?(l(),a("div",Be,c(_[0]),1)):r("",!0)]),_:1}),s.slots.length!==0?(l(),a("div",Le,[ze,e("div",Ge,[(l(!0),a(y,null,b(s.slots,(t,_)=>(l(),a("div",{class:"card-ftlist",key:_},[e("div",He,[e("div",Je,[e("div",Ke,c(t.date),1)]),e("div",Qe,[e("div",We,[e("a",{class:"btn btn-sm btn-secondary",onClick:Y(u=>f.reschedule(t,s.appointment.id),["prevent"])},[m("Book Now "),Ze],8,Xe)])])])]))),128))])])):r("",!0),s.noSlots?(l(),a("div",$e," Unfortunately, no slots available for selected date. Please check another one. ")):r("",!0)])]),e("div",et,[tt,e("button",{"data-fancybox-close":"",onClick:i[2]||(i[2]=t=>f.closeModal()),class:"f-button is-close-btn",title:"Close"},lt),e("div",at,[p(P,{"validation-schema":s.schema,onSubmit:f.updateStatus,ref:"cancelForm"},{default:v(()=>[e("div",ot,[e("div",nt,[e("div",it,[dt,p(w,{class:"form-control",name:"status",as:"select",modelValue:s.updatedStatus,"onUpdate:modelValue":i[3]||(i[3]=t=>s.updatedStatus=t),onChange:i[4]||(i[4]=t=>f.changeStatus())},{default:v(({field:t,errors:_})=>[ct,d.type=="pending"||d.type=="referral"&&s.statusAppointment.status!="Cancelled"&&s.statusAppointment.status=="Pending"&&o.$dayjs(s.statusAppointment.date).isAfter(o.$dayjs(s.currentDate))?(l(!0),a(y,{key:0},b(s.pendingStatuses,(u,k)=>(l(),a("option",{key:k,value:u.value},c(u.text),9,rt))),128)):r("",!0),d.type=="confirmed"||d.type=="referral"&&s.statusAppointment.status!="Cancelled"&&s.statusAppointment.status!="Pending"&&o.$dayjs(s.statusAppointment.date).isAfter(o.$dayjs(s.currentDate))?(l(!0),a(y,{key:1},b(s.confirmedStatuses,(u,k)=>(l(),a("option",{key:k,value:u.value},c(u.text),9,ut))),128)):r("",!0)]),_:1},8,["modelValue"]),s.statusErr?(l(),a("div",_t,mt)):r("",!0)])]),s.displayReason&&!s.displayPaymentMode?(l(),a("div",pt,[e("div",ft,[p(w,{class:"form-control",name:"reason",type:"text",modelValue:s.cancellationReason,"onUpdate:modelValue":i[5]||(i[5]=t=>s.cancellationReason=t)},{default:v(({field:t,errors:_})=>[yt,e("textarea",F({name:"reason"},t,{id:"",cols:"30",rows:"6",class:"form-control h-auto",placeholder:"Enter Reason"}),null,16),_[0]?(l(),a("div",vt,c(_[0]),1)):r("",!0)]),_:1},8,["modelValue"])])])):r("",!0),s.displayPaymentMode&&!s.displayReason?(l(),a("div",gt,[e("div",bt,[kt,p(w,{class:"form-control",name:"payment_mode",as:"select",modelValue:s.payment_mode,"onUpdate:modelValue":i[6]||(i[6]=t=>s.payment_mode=t)},{default:v(({field:t,errors:_})=>[wt,(l(!0),a(y,null,b(s.paymentMode,(u,k)=>(l(),a("option",{key:k,value:u.value},c(u.text),9,St))),128))]),_:1},8,["modelValue"]),e("div",Ct,[p(D,{class:"invalid-feedback",name:"payment_mode"})])])])):r("",!0),e("div",xt,[e("div",Mt,[e("button",At,[s.submittingForm?(l(),a("svg",Rt,Pt)):r("",!0),m(" Update ")])])])])]),_:1},8,["validation-schema","onSubmit"])])])],64)}const Yt=j(G,[["render",Vt],["__scopeId","data-v-815cd5a2"]]);export{Yt as L};
